{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/python-crawling-and-naver-map-2/",
    "result": {"data":{"cur":{"id":"f5164abf-7929-56ee-9852-634a8aaa2abb","html":"<p>안녕하세요:) 이번 포스팅에서는 파이썬 라이브러리인 플라스크에서 동작하는 네이버 지도 크롤링 서버 환경을 구축해보려고 합니다. 또한 지난 소개(1탄) 포스팅에서 말씀드린 것처럼, 크롤링 진행시 고려해보면 좋은 덕목과 크롤러 시점에서 본 네이버 지도의 특징을 소개해보려고 합니다.</p>\n<br />\n<br />\n<h2 id=\"1-크롤링-서버환경-구축\" style=\"position:relative;\"><a href=\"#1-%ED%81%AC%EB%A1%A4%EB%A7%81-%EC%84%9C%EB%B2%84%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95\" aria-label=\"1 크롤링 서버환경 구축 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 크롤링 서버환경 구축</h2>\n<p>(이 포스팅 시리즈는 mac os를 기준으로 작성되었습니다.)\n<br /></p>\n<p>먼저, 파이썬이 설치되어 있지 않으면 파이썬을 설치해줍니다.\n(침고 링크: <a href=\"https://programmers.co.kr/learn/courses/2/lessons/48\">https://programmers.co.kr/learn/courses/2/lessons/48</a>)\n파이썬 버전확인(3.4이상 필요)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python --version</code></pre></div>\n<br />\n<br />\n<ul>\n<li>파이썬 가상환경 구축\n해당 프로젝트에서만 귀속되게 라이브러리를 설치하기 위해 venv가상환경을 구축해 줍니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install virtualenv //설치\nvirtualenv 폴더이름 //생성\nsource 폴더이름/bin/activate //접속</code></pre></div>\n<br />\n<br />\n<ul>\n<li>필요한 라이브러리 설치\n크롤링에 필요한 라이브러리 목록입니다.\n현재는 필요한 라이브러리가 몇가지 없어 직접 pip install명령어를 통해 설치를 진행하지만 db연결, 스케줄러 설정 등이 추가된다면 설치해야할 라이브러리가 많아집니다.\n이때는 requirements.txt파일에 설치할 라이브러리를 명시해두고 한 번에 설치하여 라이브러리 설치 및 버전 관리를 하는 것이 좋습니다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install flask beautifulsoup4 selenium webdriver-manager</code></pre></div>\n<br />\n<br />\n<h3 id=\"설명\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EB%AA%85\" aria-label=\"설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설명</h3>\n<ul>\n<li>flask: 파이썬 웹 프레임워크로, 크롤링 서버 구축 틀</li>\n<li>beautifulsoup4: html parser로, 웹페이지 크롤링시, html태그를 효과적으로 추출하기 위함</li>\n<li>selenium: 자바스크립트가 동적으로 생성한 데이터를 크롤링하기 위함, 마우스, 키보드 등 이벤트 핸들링을 쉽게 위함</li>\n<li>webdriver-manager: 크롤링을 시도할 웹 브라우저인 크롬을 컨트롤하기 위함</li>\n</ul>\n<br />\n<br />\n<h2 id=\"플라스크-서버-실행\" style=\"position:relative;\"><a href=\"#%ED%94%8C%EB%9D%BC%EC%8A%A4%ED%81%AC-%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\" aria-label=\"플라스크 서버 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>플라스크 서버 실행</h2>\n<h3 id=\"apppy\" style=\"position:relative;\"><a href=\"#apppy\" aria-label=\"apppy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>app.py</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> argparse\n<span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask\n\n<span class=\"token comment\"># 실행 환경변수 설정</span>\nparser <span class=\"token operator\">=</span> argparse<span class=\"token punctuation\">.</span>ArgumentParser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--env'</span><span class=\"token punctuation\">,</span>required<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'development'</span><span class=\"token punctuation\">)</span>\nargs <span class=\"token operator\">=</span> parser<span class=\"token punctuation\">.</span>parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># flask app 생성</span>\napp <span class=\"token operator\">=</span> Flask<span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n  app<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token string\">'3060'</span><span class=\"token punctuation\">,</span> debug<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> use_reloader<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<br />\n<p>In terminal</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">python app.py</code></pre></div>\n<br />\n<br />\n<h2 id=\"2-크롤링시-알아두면-좋은-3가지-요소\" style=\"position:relative;\"><a href=\"#2-%ED%81%AC%EB%A1%A4%EB%A7%81%EC%8B%9C-%EC%95%8C%EC%95%84%EB%91%90%EB%A9%B4-%EC%A2%8B%EC%9D%80-3%EA%B0%80%EC%A7%80-%EC%9A%94%EC%86%8C\" aria-label=\"2 크롤링시 알아두면 좋은 3가지 요소 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 크롤링시 알아두면 좋은 3가지 요소</h2>\n<ul>\n<li>예상치 못한 상황에 대한 전처리 진행</li>\n<li>sleep의 필요성</li>\n<li>Iframe간 이동</li>\n</ul>\n<br />\n<h3 id=\"예상치-못한-상황에-대한-전처리-진행\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%83%81%EC%B9%98-%EB%AA%BB%ED%95%9C-%EC%83%81%ED%99%A9%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A0%84%EC%B2%98%EB%A6%AC-%EC%A7%84%ED%96%89\" aria-label=\"예상치 못한 상황에 대한 전처리 진행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예상치 못한 상황에 대한 전처리 진행</h3>\n<p>웹페이지 크롤링을 하다보면 생각지도 못한 부분에서 동작이 멈추거나 에러가 발생하여 강제종료되는 일이 종종 발생합니다. 많은 이유가 있지만, 크게 3가지 상황이 발생합니다.</p>\n<ol>\n<li>ul > li 내부에서 서로다른 가변적 데이터가 생성될 때</li>\n<li>웹사이트 내부 html 태그의 형식이나 이름이 변경되었을 때</li>\n<li>네트워크 통신이 불안정하여 로딩시간이 길어질때나 끊켰을 때\n위 상황에서 일단 크롤링이 계속 진행되어 작성해둔 반복문을 일단 끝까지 돌리거나 다음 항목으로 넘어가는 예외처리를 해주어야 합니다. 따라서 크롤링코드는 주기적으로 돌려보며 여러가지 실패 케이스를 찾아내고, 예외처리를 해주는 것이 바람직합니다.</li>\n</ol>\n<br />\n<h3 id=\"sleep의-필요성\" style=\"position:relative;\"><a href=\"#sleep%EC%9D%98-%ED%95%84%EC%9A%94%EC%84%B1\" aria-label=\"sleep의 필요성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sleep의 필요성</h3>\n<p>코드를 작성하고 크롤링 서버를 실행시켰을 때, 실제 코드 실행 속도와 웹 서버의 데이터 전송 시간 차이로 인해 런타임오류가 발생할 때가 존재합니다.\n이는, 브라우저 렌더링 엔진에 의한 html 파싱이 이루어 지기 전에, 이미 beautifulsoup에서 html을 parser하기 때문입니다. 이 경우 파이썬 내부함수인 time의 모듈 중 코드 실행 지연 모듈은 sleep()을 통해 실제 코드 실행속도를 웹서버와 맞추는 것이 해결책 중 하나가 됩니다. 이때, time.sleep()함수로 지연할 시간은 코드를 실행시켜보며 적절한 시간에서 조금 널널한 시간(+1~3초)을 설정해 놓는 것을 추천 드립니다.</p>\n<br />\n<h3 id=\"iframe간-이동\" style=\"position:relative;\"><a href=\"#iframe%EA%B0%84-%EC%9D%B4%EB%8F%99\" aria-label=\"iframe간 이동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Iframe간 이동</h3>\n<p>Iframe은 HTML inline Frame 요소로, 하나의 사이트에 2개 이상의 페이지를 삽입할 수 있습니다.\n<br /></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACrUlEQVQoz1WSX2scVQBH54P4FUTw1RdBEFEfTClKRV/UN6kKPtiXRqWgiCiKKIUqQvEpapBUk6KJiUgTzYLEJnTTbnY3m9m5M3fm3pk7986fnZ3sHml86u8DnB8cjheEI0QyZLu/S6wDilJjsoyrn73Fsy8+waPn3uPC+Qu88sICX35+naqeUjiLVjGhGCBCn727R6ys30TKE7zXrkX4NuJ6vIl0KWXtkLpm57t3+Ojtx3jk+cu8f+kNFl9f4KtPPiY1OVoH2FxjjUalIcbllGVJlsZ4iR8xa3lg7Rz835fYXf6Qdz/9hlur37L+8xIb638ghCCKB6hYYJ1FKUlucpwekSQ+3kQK/L83ONr5lWFni8PtFfb/+oXEt2dwXcxY7YNsIIoc/ugEZ1JUHBIEI3QWIcdHRMldVB7hFTJi84tFfrr4FF8//TCLzz3E8gdPEvYlM+bYquXP4xZdnjIWOUGkqCt35jHTMXa8R50FjM0QbRK8UkboXpew26F/+196B/8wvreP6EU004ZmMoFZw/y0IZAVOnPExhBlGVYNSdMRx1mXoT4gyw3eJA4Jgz59XzAWETrLKG2NGAiKpqQoSqwrqeoSEU9QWUVmFJE4IJDHJDZF5SNkfkyaJXizTPHDtVd5/NzLXHzpGa68ucDVK5eIBiHTWctpe0rbtsznMwJhiMZdSn2HiZPYskKaBFekpJk6O/LmuSHcu8nyjTXu3O7Q2fyRrbUbxMOEoqowpaVp/88glA6bpdT1lKpuqKqKxORIrSmrCV0/x5ublDK/72n2QDpyFCNyjVQS5yz32wrinHvhISfqiLKyuKIiNQVCCWxh2D0q8Fol6d3aoLO1zv5v37O9usTO2grBocBoRyBSVFrSTGEkSnrhgKE+xFU5dT1hUtfkzqCtInc1/wGrHxHlfx4g2QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iframeDescription.png\"\n        title=\"iframeDescription.png\"\n        src=\"/static/7c291d163e31492cfc892f355e92e6f8/37523/iframeDescription.png\"\n        srcset=\"/static/7c291d163e31492cfc892f355e92e6f8/e9ff0/iframeDescription.png 180w,\n/static/7c291d163e31492cfc892f355e92e6f8/f21e7/iframeDescription.png 360w,\n/static/7c291d163e31492cfc892f355e92e6f8/37523/iframeDescription.png 720w,\n/static/7c291d163e31492cfc892f355e92e6f8/302a4/iframeDescription.png 1080w,\n/static/7c291d163e31492cfc892f355e92e6f8/07a9c/iframeDescription.png 1440w,\n/static/7c291d163e31492cfc892f355e92e6f8/d9ed5/iframeDescription.png 2880w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>네이버 지도에서는 현재 위 사진처럼 총 2개의 Iframe이 삽입되어 있습니다.</p>\n<br />\n<ul>\n<li>빨간색 테두리: 검색 및 결과 섹션 Iframe</li>\n<li>파란색 테두리: 검색 상세 섹션 Iframe\n이렇게 한 사이트에 여러 Iframe이 존재하여 Iframe간 html 태그 선택을 넘나들때, Iframe 전환을 해줘야 합니다. Iframe 전환은 위에서 소개한 webdriver의 모듈 중에 switch_to 내부함수로 할 수 있습니다. Iframe 전환은 실제 크롤링을 진행해볼 다음 포스팅에서 자세히 살펴보겠습니다.</li>\n</ul>\n<br />\n<br />\n<h2 id=\"3-다음-포스팅-미리보기\" style=\"position:relative;\"><a href=\"#3-%EB%8B%A4%EC%9D%8C-%ED%8F%AC%EC%8A%A4%ED%8C%85-%EB%AF%B8%EB%A6%AC%EB%B3%B4%EA%B8%B0\" aria-label=\"3 다음 포스팅 미리보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 다음 포스팅 미리보기</h2>\n<p>다음 포스팅에서는 네이버 지도에서 키워드를 통한 지역 검색을 진행한 뒤, 검색결과 데이터 크롤링으로 하는 과정을 거쳐보겠습니다.</p>\n<br />\n<h3 id=\"자세한-코드는-여기에\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\" aria-label=\"자세한 코드는 여기에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자세한 코드는 <a href=\"https://github.com/jeongyunjae/yonsei-univ-matjip\">여기</a>에</h3>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-%ED%81%AC%EB%A1%A4%EB%A7%81-%EC%84%9C%EB%B2%84%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95\">1. 크롤링 서버환경 구축</a></p>\n<ul>\n<li><a href=\"#%EC%84%A4%EB%AA%85\">설명</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%ED%94%8C%EB%9D%BC%EC%8A%A4%ED%81%AC-%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\">플라스크 서버 실행</a></p>\n<ul>\n<li><a href=\"#apppy\">app.py</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-%ED%81%AC%EB%A1%A4%EB%A7%81%EC%8B%9C-%EC%95%8C%EC%95%84%EB%91%90%EB%A9%B4-%EC%A2%8B%EC%9D%80-3%EA%B0%80%EC%A7%80-%EC%9A%94%EC%86%8C\">2. 크롤링시 알아두면 좋은 3가지 요소</a></p>\n<ul>\n<li><a href=\"#%EC%98%88%EC%83%81%EC%B9%98-%EB%AA%BB%ED%95%9C-%EC%83%81%ED%99%A9%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A0%84%EC%B2%98%EB%A6%AC-%EC%A7%84%ED%96%89\">예상치 못한 상황에 대한 전처리 진행</a></li>\n<li><a href=\"#sleep%EC%9D%98-%ED%95%84%EC%9A%94%EC%84%B1\">sleep의 필요성</a></li>\n<li><a href=\"#iframe%EA%B0%84-%EC%9D%B4%EB%8F%99\">Iframe간 이동</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-%EB%8B%A4%EC%9D%8C-%ED%8F%AC%EC%8A%A4%ED%8C%85-%EB%AF%B8%EB%A6%AC%EB%B3%B4%EA%B8%B0\">3. 다음 포스팅 미리보기</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\">자세한 코드는 여기에</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"안녕하세요:) 이번 포스팅에서는 파이썬 라이브러리인 플라스크에서 동작하는 네이버 지도 크롤링 서버 환경을 구축해보려고 합니다. 또한 지난 소개(1탄) 포스팅에서 말씀드린 것처럼, 크롤링 진행시 고려해보면 좋은 덕목과 크롤러 시점에서 본 네이버 지도의 특징을 소개해보려고 합니다. 1. 크롤링 서버환경 구축 (이 포스팅 시리즈는 mac os를 기준으로 작성되었습니다.)\n 먼저, 파이썬이 설치되어 있지 않으면 파이썬을 설치해줍니다.\n(침고 링크: https://programmers.co.kr/learn/courses/2/lessons/48)\n파이썬 버전확인(3.4이상 필요) 파이썬 가상환경 구축\n해당 프로젝트에서만 귀속되게 라이브러리를 설치하기 위해 venv가상환경을 구축해 줍니다. 필요한 라이브러리 설치\n크롤링에 필요한 라이브러리 목록입니다.\n현재는 필요한 라이브러리가 몇가지 없어 직접 pip install명령어를 통해 설치를 진행하지만 db연결, 스케줄러 설정 등이 추가된다면 설치해…","frontmatter":{"date":"May 28, 2022","title":"네이버지도로 지도 서비스 만들기 - 2탄","categories":"지도서비스","author":"윤로그","emoji":"🗺"},"fields":{"slug":"/python-crawling-and-naver-map-2/"}},"next":{"id":"467035a6-7bc3-59ad-8d2a-6384633db70e","html":"<h2 id=\"배경\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EA%B2%BD\" aria-label=\"배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배경</h2>\n<p>네이버 지도를 기반으로 지도 서비스를 개발 하시려는 분들께 도움을 드리고자 글을 써보려고합니다!\n현재 구글에 <strong>지도 서비스 만들기</strong> 로 검색 했을 때, 카카오 지도 크롤링 관련해서는 어느정도 검색결과가 나오는 편이지만,\n네이버 지도는 검색결과가 적어 정보를 얻기 힘듭니다. 또한 리액트에서 네이버 지도 연동과정에서 주로 다뤄지는 <a href=\"https://www.npmjs.com/package/react-naver-maps\">react-naver-maps</a>는 간단한 기능으로 구성되는 지도서비스를 만들기에는 나쁘지 않은 라이브러리일 수 있지만, 지도에 다양한 기능(커스텀 클러스터, 지도 이벤트 핸들링)이 있어야 할때는 javascript 기반 <a href=\"https://navermaps.github.io/maps.js.ncp/docs/\">네이버 지도 API</a>를 사용해야 합니다.\n그래서 데이터 크롤링과 지도를 표시해줄 프론트 모두 <strong>네이버 지도</strong>를 기반으로 한 사이드 프로젝트를 진행하며 여러 회차에 걸쳐\n포스팅해보려고합니다:)</p>\n<h2 id=\"1-진행해볼-사이드-프로젝트-설명\" style=\"position:relative;\"><a href=\"#1-%EC%A7%84%ED%96%89%ED%95%B4%EB%B3%BC-%EC%82%AC%EC%9D%B4%EB%93%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EB%AA%85\" aria-label=\"1 진행해볼 사이드 프로젝트 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 진행해볼 사이드 프로젝트 설명</h2>\n<blockquote>\n<p>연세대학교 신촌캠퍼스 맛집 지도 🗺</p>\n</blockquote>\n<ol>\n<li>네이버 지도(v5)에 ‘연세대학교 신촌캠퍼스 맛집’을 검색하고 데이터를 추출하는 플라스크(Flask)크롤링서버를 구축한다.</li>\n<li>추출한 데이터를 프론트의 요청에 맞게 REST-API로 전달한다.</li>\n<li>전달받은 지도 데이터를 기능에 맞게 화면에 보여준다.</li>\n</ol>\n<h2 id=\"2-개발-환경-구성\" style=\"position:relative;\"><a href=\"#2-%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\" aria-label=\"2 개발 환경 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 개발 환경 구성</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 465px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz5WTbW/aMBSF8///TdUXbZOAMU2M9kPV7cMETUgakhCgJMtMILET/FR1h4AJ0nKlI1u6PsfnXvtaxaxLFrYRUYc/QYs87iKiNjK5Zb0SVFVNnucsl0uEEGZf1TV5liHu+iy6HeZf28w6LZb9HpYIW4x/XxINrs06cz4xtW9Yz3+QJnNKKYnjmDAMiaLIQCrFIp4g+j2CL58Z3VzxeHnB3953LL16hNJFr2zy558gPZAum7VHY2hN6bmokUPljgxKx8bSwEa/nQmCAM974skPUFX9j6dPwuT/g/WW0BSywvUnFKVESrkjnBI6cYn1mpSqZjCR/Aoqxgu1reiAvKv0A4Kl2vAwyrgbJLjTwqjpPdI5YQRVrbm3E749RHiz4sDBuWFtyXmpSfONcbtfclMPjwruEtt3Ouzf8R+j33d4zEVRFGRZRpqmZlKSJEEp1eywycGrmOM4DIdDfN/Htm0zfk2CL3+Vomvu/fhjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"structure.png\"\n        title=\"structure.png\"\n        src=\"/static/2c0f819fa2abefe3cac243345ff930bc/9ff85/structure.png\"\n        srcset=\"/static/2c0f819fa2abefe3cac243345ff930bc/e9ff0/structure.png 180w,\n/static/2c0f819fa2abefe3cac243345ff930bc/f21e7/structure.png 360w,\n/static/2c0f819fa2abefe3cac243345ff930bc/9ff85/structure.png 465w\"\n        sizes=\"(max-width: 465px) 100vw, 465px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>Back-end</p>\n<ul>\n<li>Flask</li>\n</ul>\n</li>\n<li>\n<p>Front-end</p>\n<ul>\n<li>React</li>\n<li>Typescript</li>\n</ul>\n</li>\n</ul>\n<p>백엔드는 네이버 지도를 크롤링하여 데이터를 저장하는 동시에, 프론트엔드와 REST-API로 통신할 FLASK 서버를 준비합니다.\n프론트엔드는 자바스크립트 기반 프레임워크인 리액트(React)로 구성되고, 언어는 타입스크립트로 작성합니다.</p>\n<p>다음 포스팅에서는 크롤링 서버 환경을 구축하고 크롤링시에 알아두면 좋은 정보들을 실제 코드 작성 이전에 소개드리겠습니다.</p>\n<h3 id=\"자세한-코드는-여기에\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\" aria-label=\"자세한 코드는 여기에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자세한 코드는 <a href=\"https://github.com/jeongyunjae/yonsei-univ-matjip\">여기</a>에</h3>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B0%B0%EA%B2%BD\">배경</a></p>\n</li>\n<li>\n<p><a href=\"#1-%EC%A7%84%ED%96%89%ED%95%B4%EB%B3%BC-%EC%82%AC%EC%9D%B4%EB%93%9C-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%84%A4%EB%AA%85\">1. 진행해볼 사이드 프로젝트 설명</a></p>\n</li>\n<li>\n<p><a href=\"#2-%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1\">2. 개발 환경 구성</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\">자세한 코드는 여기에</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"May 01, 2022","title":"네이버지도로 지도 서비스 만들기 - 1탄","categories":"지도서비스","author":"윤로그","emoji":"🗺"},"fields":{"slug":"/python-crawling-and-naver-map-1/"}},"prev":{"id":"c3a6d875-7d98-542c-8220-52012d559530","html":"<h3>\n안녕하세요 :)\n<br />\n<br />\n이번 포스팅에서는 Selenium 라이브러리를 이용해서 지도에 검색어를 입력하고, 검색결과 데이터를 추출하는 과정을 담아보았습니다.\n</h3>\n<br />\n<h2 id=\"1-크롤링-시나리오\" style=\"position:relative;\"><a href=\"#1-%ED%81%AC%EB%A1%A4%EB%A7%81-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\" aria-label=\"1 크롤링 시나리오 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 크롤링 시나리오</h2>\n<ol>\n<li>크롬 브라우저를 열어 <a href=\"https://map.naver.com/v5/\">네이버 지도</a> 으로 이동한다.</li>\n<li>장소 검색에 “연세대학교 맛집”을 검색한다.</li>\n<li>검색된 매장리스트에서 매장별 정보(ex. 매장명, 주소 등)를 추출하여 csv파일에 저장한다.</li>\n<li>현재 페이지에 있는 매장별 정보를 전부 얻었다면 다음페이지로 이동한다.</li>\n<li>다음 페이지가 존재하지 않으면 크롤링을 종료하며, 브라우저를 닫는다.</li>\n</ol>\n<br />\n<h2 id=\"2-프로젝트-구조\" style=\"position:relative;\"><a href=\"#2-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B5%AC%EC%A1%B0\" aria-label=\"2 프로젝트 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 프로젝트 구조</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">├── src\n│   ├── list.csv\n│   ├── naver_crawl.py\n│\n├── app.py\n└── requirements.txt</code></pre></div>\n<br />\n<ul>\n<li>list.csv: 크롤링된 매장정보를 저장할 파일</li>\n<li>naver_crawl.py: 크롤링에 필요한 모듈들을 정의한 파일</li>\n<li>app.py: 앱의 시작점</li>\n<li>requirements.txt: 프로젝트에 사용되는 라이브러리를 한 곳에 작성해둔 파일</li>\n</ul>\n<br />\n<h2 id=\"3-함수-기능-설명\" style=\"position:relative;\"><a href=\"#3-%ED%95%A8%EC%88%98-%EA%B8%B0%EB%8A%A5-%EC%84%A4%EB%AA%85\" aria-label=\"3 함수 기능 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 함수 기능 설명</h2>\n<p><code class=\"language-text\">naver_crawl.py</code>에 크롤링에 필요한 여러 모듈들이 정의되어 있습니다. 해당 파일에는 크롤링에 이용되는 여러 함수들이 선언되어 있으며 하나하나 뜯어봅시다.\n<br /></p>\n<h3 id=\"get_driver-크롬브라우저-실행\" style=\"position:relative;\"><a href=\"#get_driver-%ED%81%AC%EB%A1%AC%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EC%8B%A4%ED%96%89\" aria-label=\"get_driver 크롬브라우저 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>get_driver (크롬브라우저 실행)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># module import</span>\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> webdriver_manager<span class=\"token punctuation\">.</span>chrome <span class=\"token keyword\">import</span> ChromeDriverManager\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_driver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  options <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>ChromeOptions<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 지정한 user-agent로 설정</span>\n  options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span>\"user<span class=\"token operator\">-</span>agent<span class=\"token operator\">=</span>Mozilla<span class=\"token operator\">/</span><span class=\"token number\">5.0</span> <span class=\"token punctuation\">(</span>Macintosh<span class=\"token punctuation\">;</span> Intel Mac OS X <span class=\"token number\">10_12_6</span><span class=\"token punctuation\">)</span>\n  AppleWebKit<span class=\"token operator\">/</span><span class=\"token number\">537.36</span> <span class=\"token punctuation\">(</span>KHTML<span class=\"token punctuation\">,</span> like Gecko<span class=\"token punctuation\">)</span> Chrome<span class=\"token operator\">/</span><span class=\"token number\">96.0</span><span class=\"token number\">.4664</span> Safari<span class=\"token operator\">/</span><span class=\"token number\">537.36</span>\"<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 크롬 화면 크기를 설정(but 반응형 사이트에서는 html요소가 달라질 수 있음)</span>\n  options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">\"window-size=1440x900\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 브라우저가 백그라운드에서 실행되며, 보통 로컬환경에서는 크롤링 진행과정을 보면서 개발하는게 좋기 때문에 주석처리합니다.</span>\n  options<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">\"headless\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># ChromeDriverManager를 통해 현재 OS에 설치된 크롬브라우저 버전을 다운로드하고, 설정한 옵션을 적용합니다.</span>\n  driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>Service<span class=\"token punctuation\">(</span>ChromeDriverManager<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>install<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>options<span class=\"token operator\">=</span>options<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 네이버 지도로 이동</span>\n  driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://map.naver.com'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 네이버 지도로 이동될 때까지 기다리는 최대 시간(초 단위)</span>\n  driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> driver</code></pre></div>\n<br />\n<h3 id=\"장소-검색-함수search_place\" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%86%8C-%EA%B2%80%EC%83%89-%ED%95%A8%EC%88%98search_place\" aria-label=\"장소 검색 함수search_place permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>장소 검색 함수(search_place)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># @param driver: 생성했던 driver</span>\n<span class=\"token comment\"># @param search_text: 검색할 키워드</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">search_place</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">:</span>WebDriver<span class=\"token punctuation\">,</span> search_text<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># 검색창 element 선택</span>\n  search_input_box <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">\"div.input_box>input.input_search\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 선택한 검색창에 검색할 키워드 입력</span>\n  search_input_box<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>search_text<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 엔터키 이벤트</span>\n  search_input_box<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 검색에 걸리는 시간보다 조금 더 넉넉하게 정지</span>\n  time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<h3 id=\"페이지-이동-및-마지막-페이지-체크-함수next_page_move\" style=\"position:relative;\"><a href=\"#%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%9D%B4%EB%8F%99-%EB%B0%8F-%EB%A7%88%EC%A7%80%EB%A7%89-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%B2%B4%ED%81%AC-%ED%95%A8%EC%88%98next_page_move\" aria-label=\"페이지 이동 및 마지막 페이지 체크 함수next_page_move permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>페이지 이동 및 마지막 페이지 체크 함수(next_page_move)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># @param driver: 생성했던 driver</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">next_page_move</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">:</span>WebDriver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># 페이지네이션 영역에 마지막 버튼 element 선택</span>\n  next_page_btn <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'div._2ky45>a:last-child'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 선택한 element을 html로 파싱하여 문자열 텍스트 가져올 준비</span>\n  next_page_class_name <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>next_page_btn<span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"html.parser\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 현재 페이지가 마지막 페이지일때, class의 이름이 달라짐을 이용한 조건문</span>\n  <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>next_page_class_name<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">10</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"검색완료\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 웹 드라이버 종료</span>\n    driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span>\n  <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 다음페이지 이동버튼 클릭</span>\n    next_page_btn<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>ENTER<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></code></pre></div>\n<br />\n<p><code class=\"language-text\">if len(next_page_class_name.text) > 10:</code>이 조건문 같은 경우, 조건에 사용되는 class의 길이는 언제든지 달라질 수 있어\n바꿔줘야할 수도 있습니다.</p>\n<h3 id=\"검색결과-iframe-이동-함수to_search_iframe\" style=\"position:relative;\"><a href=\"#%EA%B2%80%EC%83%89%EA%B2%B0%EA%B3%BC-iframe-%EC%9D%B4%EB%8F%99-%ED%95%A8%EC%88%98to_search_iframe\" aria-label=\"검색결과 iframe 이동 함수to_search_iframe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>검색결과 iframe 이동 함수(to_search_iframe)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># @param driver: 생성했던 driver</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">to_search_iframe</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">:</span>WebDriver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>default_content<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">(</span><span class=\"token string\">'searchIframe'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p><a href=\"https://yunjaaae.com/python-crawling-and-naver-map-2/#iframe%EA%B0%84-%EC%9D%B4%EB%8F%99\">이전 포스팅</a>에서 설명했듯이, 한 화면에 여러 Iframe이 있어 html 태그 선택을 넘나들기 위해, <code class=\"language-text\">driver.switch_to.default_content()</code>로 기본 Iframe 이동 후, 검색결과 Iframe의 id안 ‘searchIframe’를 argument로 하는 <code class=\"language-text\">driver.switch_to.frame('searchIframe')</code>를 실행시켜\n<br />\nIframe 전환을 진행합니다.</p>\n<h3 id=\"selector-element를-텍스트로-변환-하는-함수get_element_to_text\" style=\"position:relative;\"><a href=\"#selector-element%EB%A5%BC-%ED%85%8D%EC%8A%A4%ED%8A%B8%EB%A1%9C-%EB%B3%80%ED%99%98-%ED%95%98%EB%8A%94-%ED%95%A8%EC%88%98get_element_to_text\" aria-label=\"selector element를 텍스트로 변환 하는 함수get_element_to_text permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>selector element를 텍스트로 변환 하는 함수(get_element_to_text)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># @param element: &lt;class \"str\"></span>\n<span class=\"token comment\"># @return str</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_element_to_text</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">return</span> BeautifulSoup<span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">,</span> <span class=\"token string\">\"html.parser\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_text<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<h3 id=\"get_store_data-함수-매장정보-추출\" style=\"position:relative;\"><a href=\"#get_store_data-%ED%95%A8%EC%88%98-%EB%A7%A4%EC%9E%A5%EC%A0%95%EB%B3%B4-%EC%B6%94%EC%B6%9C\" aria-label=\"get_store_data 함수 매장정보 추출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>get_store_data 함수 (매장정보 추출)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token comment\"># @param driver: 생성했던 driver</span>\n<span class=\"token comment\"># @paramscroll_container: 검색결과 스크롤 영역</span>\n<span class=\"token comment\"># @param file: 저장할 파일</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_store_data</span><span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">:</span>WebDriver<span class=\"token punctuation\">,</span> scroll_container<span class=\"token punctuation\">:</span> WebElement<span class=\"token punctuation\">,</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span> TextIOWrapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n  <span class=\"token comment\"># 검색결과 목록 li element들을 선택</span>\n  get_store_li <span class=\"token operator\">=</span> scroll_container<span class=\"token punctuation\">.</span>find_elements_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'ul > li'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 현재 페이지에 존재하는 매장목록만큼 반복</span>\n  <span class=\"token keyword\">for</span> index <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>get_store_li<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    selectorArgument <span class=\"token operator\">=</span> <span class=\"token string\">'div:nth-of-type(1) > a'</span>\n    wrapper_html <span class=\"token operator\">=</span> get_store_li<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'innerHTML'</span><span class=\"token punctuation\">)</span>\n    wrapper_soup <span class=\"token operator\">=</span> BeautifulSoup<span class=\"token punctuation\">(</span>wrapper_html<span class=\"token punctuation\">,</span> <span class=\"token string\">\"html.parser\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 매장 항목 클릭</span>\n    get_store_li<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span>selectorArgument<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 매장 Iframe으로 이동</span>\n    driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>default_content<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">(</span><span class=\"token string\">'entryIframe'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#로딩 시간 적용</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 상세정보 페이지가 완전히 로딩될때까지 기다림</span>\n        WebDriverWait<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>until<span class=\"token punctuation\">(</span>EC<span class=\"token punctuation\">.</span>presence_of_element_located<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CLASS_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"place_didmount\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">except</span> TimeoutException<span class=\"token punctuation\">:</span>\n        to_search_iframe<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># 매장명 element 추출</span>\n      store_name <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'#_title > span:nth-child(1)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'innerHTML'</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># 네이버 카테고리 element 추출</span>\n      <span class=\"token keyword\">if</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'#_title > span._3ocDE'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>is_displayed<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        naver_category <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'#_title > span._3ocDE'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'innerHTML'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        naver_category <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\n      <span class=\"token comment\"># 매장주소 element 추출</span>\n      address <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'.place_section_content > ul ._2yqUQ'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'innerHTML'</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># driver로 선택한 element를 텍스트로 변환</span>\n      store_name <span class=\"token operator\">=</span> get_element_to_text<span class=\"token punctuation\">(</span>store_name<span class=\"token punctuation\">)</span>\n      address <span class=\"token operator\">=</span> get_element_to_text<span class=\"token punctuation\">(</span>address<span class=\"token punctuation\">)</span>\n      naver_category <span class=\"token operator\">=</span> get_element_to_text<span class=\"token punctuation\">(</span>naver_category<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># csv파일에 매장정보 저장</span>\n      <span class=\"token builtin\">file</span><span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>store_name <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> address <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> naver_category <span class=\"token operator\">+</span> <span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span>\n      to_search_iframe<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> TimeoutException<span class=\"token punctuation\">:</span>\n      to_search_iframe<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<br />\n<h3 id=\"naver_crawl-함수-메인-실행-함수\" style=\"position:relative;\"><a href=\"#naver_crawl-%ED%95%A8%EC%88%98-%EB%A9%94%EC%9D%B8-%EC%8B%A4%ED%96%89-%ED%95%A8%EC%88%98\" aria-label=\"naver_crawl 함수 메인 실행 함수 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>naver_crawl 함수 (메인 실행 함수)</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">naver_crawl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\"># 매장정보를 저장할 파일 오픈</span>\n  list_file <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/list.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 웹 드라이버</span>\n  driver <span class=\"token operator\">=</span> get_driver<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 장소 검색</span>\n  search_place<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span><span class=\"token string\">'연세대학교 맛집'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\"># 검색결과 Iframe으로 이동</span>\n  to_search_iframe<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n\n  time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 검색결과목록 스크롤 element 선택</span>\n    scroll_container <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"_pcmap_list_scroll_container\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"스크롤 영역 감지 실패\"</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 스크롤을 내리는 자바스크립트 코드 실행</span>\n        driver<span class=\"token punctuation\">.</span>execute_script<span class=\"token punctuation\">(</span><span class=\"token string\">\"arguments[0].scrollBy(0,2000)\"</span><span class=\"token punctuation\">,</span>scroll_container<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># 매장정보 저장</span>\n      get_store_data<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span>scroll_container<span class=\"token punctuation\">,</span>list_file<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\"># 다음페이지가 있는지 확인 여부</span>\n      is_continue <span class=\"token operator\">=</span> next_page_move<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> is_continue <span class=\"token operator\">==</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">break</span>\n  <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"크롤링 과정 중 에러 발생\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br />\n<p>네이버 지도같은 경우, 여타 유명한 지도(ex. 카카오맵)와 다르게 스크롤 시, 데이터 렌더링이 적용되어 있기 때문에 스크롤을 맨 하단으로 이동시켜야지 요소 접근에 문제가 생기지 않습니다. 위 코드에서는 반복문을 사용하여 총 6번 스크롤을 실행시켰는데,\n반복문 횟수는 직접 적용해가면서 최적화 시키는 것을 추천드립니다.</p>\n<br />\n<h2 id=\"4-결과물\" style=\"position:relative;\"><a href=\"#4-%EA%B2%B0%EA%B3%BC%EB%AC%BC\" aria-label=\"4 결과물 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 결과물</h2>\n<h3 id=\"listcsv\" style=\"position:relative;\"><a href=\"#listcsv\" aria-label=\"listcsv permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>list.csv</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">store_name|address|naver_category\n티아레나|서울 서대문구 연희맛로 43-2|홍차전문점\n에스크투데이|서울 서대문구 연희로11가길 56 2층|카페,디저트\n카멜로연남|서울 마포구 연희로1길 57 1.5층|양식\n치플레|서울 마포구 동교로 262-9 1층|베이커리\n공복식당|서울 서대문구 연세로12길 23 1층|돼지고기구이\n정육면체|서울 서대문구 연세로5다길 22-8 1층 정육면체|아시아음식\n카라멘야|서울 서대문구 연세로7안길 34-1 1층|일본식라면\n앤티크커피|서울 마포구 연희로 25-1 1층 앤티크커피|카페,디저트</code></pre></div>\n<br />\n<h2 id=\"5-다음-포스팅-미리보기\" style=\"position:relative;\"><a href=\"#5-%EB%8B%A4%EC%9D%8C-%ED%8F%AC%EC%8A%A4%ED%8C%85-%EB%AF%B8%EB%A6%AC%EB%B3%B4%EA%B8%B0\" aria-label=\"5 다음 포스팅 미리보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 다음 포스팅 미리보기</h2>\n<p>다음 포스팅에서는 저장된 매장정보에서 주소를 naver geolocation기능을 사용해 위도 경도를 반환하는 과정과,\n현재 저장된 형태인 csv파일 형태에서 실제 db의 테이블로 저장하는 과정을 담아보겠습니다\n감사합니다</p>\n<h3 id=\"자세한-코드는-여기에\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\" aria-label=\"자세한 코드는 여기에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>자세한 코드는 <a href=\"https://github.com/jeongyunjae/yonsei-univ-matjip\">여기</a>에</h3>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-%ED%81%AC%EB%A1%A4%EB%A7%81-%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4\">1. 크롤링 시나리오</a></p>\n</li>\n<li>\n<p><a href=\"#2-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B5%AC%EC%A1%B0\">2. 프로젝트 구조</a></p>\n</li>\n<li>\n<p><a href=\"#3-%ED%95%A8%EC%88%98-%EA%B8%B0%EB%8A%A5-%EC%84%A4%EB%AA%85\">3. 함수 기능 설명</a></p>\n<ul>\n<li><a href=\"#get_driver-%ED%81%AC%EB%A1%AC%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EC%8B%A4%ED%96%89\">get_driver (크롬브라우저 실행)</a></li>\n<li><a href=\"#%EC%9E%A5%EC%86%8C-%EA%B2%80%EC%83%89-%ED%95%A8%EC%88%98search_place\">장소 검색 함수(search_place)</a></li>\n<li><a href=\"#%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%9D%B4%EB%8F%99-%EB%B0%8F-%EB%A7%88%EC%A7%80%EB%A7%89-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%B2%B4%ED%81%AC-%ED%95%A8%EC%88%98next_page_move\">페이지 이동 및 마지막 페이지 체크 함수(next_page_move)</a></li>\n<li><a href=\"#%EA%B2%80%EC%83%89%EA%B2%B0%EA%B3%BC-iframe-%EC%9D%B4%EB%8F%99-%ED%95%A8%EC%88%98to_search_iframe\">검색결과 iframe 이동 함수(to_search_iframe)</a></li>\n<li><a href=\"#selector-element%EB%A5%BC-%ED%85%8D%EC%8A%A4%ED%8A%B8%EB%A1%9C-%EB%B3%80%ED%99%98-%ED%95%98%EB%8A%94-%ED%95%A8%EC%88%98get_element_to_text\">selector element를 텍스트로 변환 하는 함수(get_element_to_text)</a></li>\n<li><a href=\"#get_store_data-%ED%95%A8%EC%88%98-%EB%A7%A4%EC%9E%A5%EC%A0%95%EB%B3%B4-%EC%B6%94%EC%B6%9C\">get_store_data 함수 (매장정보 추출)</a></li>\n<li><a href=\"#naver_crawl-%ED%95%A8%EC%88%98-%EB%A9%94%EC%9D%B8-%EC%8B%A4%ED%96%89-%ED%95%A8%EC%88%98\">naver_crawl 함수 (메인 실행 함수)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-%EA%B2%B0%EA%B3%BC%EB%AC%BC\">4. 결과물</a></p>\n<ul>\n<li><a href=\"#listcsv\">list.csv</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#5-%EB%8B%A4%EC%9D%8C-%ED%8F%AC%EC%8A%A4%ED%8C%85-%EB%AF%B8%EB%A6%AC%EB%B3%B4%EA%B8%B0\">5. 다음 포스팅 미리보기</a></p>\n<ul>\n<li><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%97%AC%EA%B8%B0%EC%97%90\">자세한 코드는 여기에</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 12, 2022","title":"네이버지도로 지도 서비스 만들기 - 3탄","categories":"지도서비스","author":"윤로그","emoji":"🗺"},"fields":{"slug":"/python-crawling-and-naver-map-3/"}},"site":{"siteMetadata":{"siteUrl":"https://www.yunjaaae.com","comments":{"utterances":{"repo":"jeongyunjae/jeongyunjae.github.io"}}}}},"pageContext":{"slug":"/python-crawling-and-naver-map-2/","nextSlug":"/python-crawling-and-naver-map-1/","prevSlug":"/python-crawling-and-naver-map-3/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}